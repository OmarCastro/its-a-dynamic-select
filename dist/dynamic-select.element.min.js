var Gt=Object.defineProperty;var Kt=(e,t)=>{for(var o in t)Gt(e,o,{get:t[o],enumerable:!0})};var lt=`<div class="container"> <span class="input"></span> <dialog class="dropdown" popover=""> <div class="filters"> <input class="search-input"> </div> <ul class="value-list"></ul> <div class="buttons"> <button class="ok">OK</button> <button class="cancel">Cancel</button> </div> </dialog> <div class="dynamic-options"></div>
</div>
`;var ct=`:host{display:inline-block}@scope (.container) to (:is(.option-content,.loading-notification)){.multi-input{line-height:2em;display:inline-flex;flex-direction:row;align-items:center;position:relative;color:buttontext;padding:.125em .5em;width:100%;>.selected-options{z-index:1;position:relative;pointer-events:none;flex:1}}.background-button{position:absolute;inset:0}.container{display:inline-block;position:relative;width:100%}.dropdown{border:none;box-sizing:border-box;&.top-direction{transform:translateY(-100%)}&.left-direction{transform:translate(-100%)}&.top-direction.left-direction{transform:translate(-100%,-100%)}}.selected-value{width:100%;position:relative;color:buttontext;padding:.125em .5em;min-height:1lh;white-space:nowrap;display:flex;.option{z-index:1;position:relative;pointer-events:none;flex:1}}.collapse-arrow{--arrow-size: .2em;margin-left:.5em;margin-right:.5ch;height:0;padding:var(--arrow-size);border:solid currentColor;opacity:70%;border-width:0 var(--arrow-size) var(--arrow-size) 0;display:inline-block;transform:translateY(calc(var(--arrow-size) * -1)) rotate(45deg);transform-origin:calc(50% + var(--arrow-size)/2) calc(50% + var(--arrow-size)/2);pointer-events:none;align-self:center;:host([open]) &{transform:translateY(calc(var(--arrow-size) * -1)) rotate(225deg)}}.multiselect-option{line-height:1em;border:1px solid color-mix(in srgb,currentColor,transparent 50%);border-radius:.5em;margin:.2em .25em;padding:.2em .5em;white-space:nowrap;display:inline-flex;gap:.5ch;align-items:center}.value-list{list-style:none;padding:0}.option-group header{font-weight:700}.input{display:inline-flex;width:100%}.dynamic-options{display:none}.multi-input--input-field{background:none}.multiselect-option>.deselect-option,.clear-button{--b: .15em;--s: .2em;--c: currentColor;content:" ";display:inline-block;height:1em;aspect-ratio:1;box-sizing:border-box;--g:conic-gradient(var(--c) 0 0) no-repeat 50%/;background:var(--g) var(--b) calc(100% - 2*var(--s)),var(--g) calc(100% - 2*var(--s)) var(--b);rotate:45deg;opacity:.5;appearance:none;border:none;color:inherit;pointer-events:all;&:hover{cursor:pointer;opacity:1}}.multi-input:not(:has(.multiselect-option:nth-child(2))) .clear-button{display:none}.option-checked-indicator{display:none;float:right}.search-input{width:100%;margin:auto;box-sizing:border-box}.buttons{display:none;text-align:right;& button{appearance:none;background:none;border:none;margin:1em;font-weight:700}}.option-group .option{padding-left:1em}}@scope (.container[data-ui-mode="mobile"]) to (:is(.option-content,.loading-notification)){.dropdown{padding:0;margin:0;border-radius:.5em;font-size:large;box-shadow:0 4px 8px #0003,0 6px 20px #00000030;width:90vw;max-height:90vh;overscroll-behavior:contain}.filters{position:relative;text-align:center}.search-input{width:90%;margin:auto}.option-value{padding:.1em 1em}.option-checked-indicator{display:inline-block}}.option-content:not(.option-content *){display:contents}:host([multiple]) .container[data-ui-mode=mobile] .buttons:not(.option-content *){display:flex;flex-direction:row-reverse}.option-value:not(.option-content *){&[aria-selected=true],&:hover{background-color:#0000001a}&[data-focused]{outline:dashed currentColor}.container[data-ui-mode=mobile] &{background-color:transparent;&:not(:last-child){border-bottom:solid 1px rgba(0,0,0,.2)}}}.container[load-mode=async][data-ui-mode=mobile] .dropdown{height:90vh}@media screen and (forced-colors:active){.option-value:not(.option-content *){&[aria-selected=true],&:hover{background-color:Mark;color:MarkText;>*{background-color:inherit;color:inherit}}}}.loading-notification:not(.loading-notification *){display:none;.container[data-loading] &{display:block}}.default-loader{--radius: 1em;--diameter: calc(var(--radius) * 2);display:flex;gap:1em;align-items:center;justify-content:center;padding:.5em}.default-loader>.dot:not(.option-content *){border-radius:50%;background-color:#8888;width:var(--diameter);height:var(--diameter);animation:default-loader-animation 1.8s infinite ease-in-out;animation-fill-mode:both;font-size:7px;position:relative;animation-delay:-.16s;display:inline-block;&:nth-of-type(2){animation-delay:.16s}&:nth-of-type(3){animation-delay:.32s}}@keyframes default-loader-animation{0%,80%,to{clip-path:circle(var(--radius))}40%{clip-path:circle(0)}}
`;var Yt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Xt=/\\(\\)?/g,ut={};function Zt(e){let t=ut[e];if(t)return t;let o=[];e.at(0)==="."&&o.push(""),e.replace(Yt,function(r,a,s,i){return o.push(s?i.replace(Xt,"$1"):a||r),""});let n=Object.freeze(o);return ut[e]=n,n}function D(e,t){if(e==null)return e;let o=Zt(t),n=e;for(let r of o)if(n=n[r],n==null)return n;return n}function pt(e){return e===void 0?"":typeof e=="object"?JSON.stringify(e):String(e)}function dt(e,t){switch(e.tagName){case"SLOT":{let o=e.getAttribute("name")??"";if(o.startsWith("$.")){e.removeAttribute("name");let n=pt(D(t,o.slice(2))),r=e.parentNode;e.replaceWith(n),r?.normalize()}break}case"TEMPLATE":{let o=e.getAttribute("data-each")??"";if(o.startsWith("$.")){let n=D(t,o.slice(2));if(Array.isArray(n)){let r=n.map(a=>v(e,a));e.replaceWith(...r);return}}}}for(let{name:o,value:n}of e.attributes)if(n.startsWith("$.")){let r=pt(D(t,n.slice(2)));e.setAttribute(o,r)}else n.startsWith("$?.")?!!D(t,n.slice(3))?e.setAttribute(o,""):e.removeAttribute(o):n.startsWith("$$")&&e.setAttribute(o,n.slice(1));for(let o of e.children)dt(o,t)}function v(e,t){let o=e.content.cloneNode(!0);for(let n of[...o.children])dt(n,t);return o}var h=e=>!!e&&[null,Object.prototype].includes(Object.getPrototypeOf(e));function w(e){let t={text:e.textContent||"",value:e.value},o=e.getAttribute("data-of-option");if(o!=null&&o.trim()!=="")try{let n=JSON.parse(o);if(!h(n))throw Error("data-of-option attr must be serialized json object");return{...t,selected:e.selected,origin:"option",data:{...n,...t}}}catch{}return{...t,selected:e.selected,origin:"option",data:t}}function Y(e){let t=document.createElement("option");return t.textContent=e.text,t.value=e.value,t.selected=e.selected,t.setAttribute("data-of-option",JSON.stringify(e.data)),t}function I(e){let t=()=>{let o=e();return t=()=>o,o};return()=>t()}var ft='<template id="option"><span data-value="$.value"><slot name="$.text"></slot></span></template><template id="option-list"><span data-value="$.value"><slot name="$.text"></slot></span></template><template id="single-select-input"><span class="selected-value"><button class="background-button"></button><span class="option"><span class="option-content"><slot data-value="$.selectedOption" name="selected-option"></slot></span></span><span class="collapse-arrow" role="presentation"></span></span></template><template id="multi-select-input"><span class="multi-input"><button class="background-button"></button><span class="selected-options"><template data-each="$.selectedOptions"><span data-value="$.value" class="option multiselect-option"><span class="option-content"><slot data-value="$." name="selected-option"></slot></span><button class="deselect-option" tabindex="-1"></button></span></template></span><a class="clear-button"></a><i class="collapse-arrow" role="presentation"></i></span></template><template id="multi-select-input--mobile"><span class="multi-input"><button class="background-button"></button><span class="selected-options"><template data-each="$.selectedOptions"><span data-value="$.value" class="option multiselect-option"><span class="option-content"><slot data-value="$." name="selected-option"></slot></span></span></template></span><i class="collapse-arrow" role="presentation"></i></span></template><template id="dropdown-list"><template data-each="$.ungroupedOptions"><li class="option-value" data-value="$.value" aria-selected="$.selected" data-focused="$?.focused"><label><span class="option"><span class="option-content"><slot data-value="$." name="option"></slot></span></span><input value="$.value" class="option-checked-indicator" type="$.checkedIndicatorType" checked="$?.selected"></label></li></template><template data-each="$.optionGroups"><li class="option-group"><header><slot name="$.groupName"></slot></header><ul class="value-list"><template data-each="$.options"><li class="option-value" data-value="$.value" aria-selected="$.selected" data-focused="$?.focused"><label><span class="option"><slot data-value="$." name="option"></slot></span><input value="$.value" class="option-checked-indicator" type="$.checkedIndicatorType" checked="$?.selected"></label></li></template></ul></li></template><span class="loading-notification"><slot name="loading-notification"></slot></span></template><template id="loading-notification"><div class="default-loader"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div></template>';var A=I(()=>{let e=document.createElement("template");e.innerHTML=ft;let t=n=>{let r=e.content.querySelector("template#"+n);if(!(r instanceof HTMLTemplateElement))throw Error(`Error: default template "${JSON.stringify(n)}" not defined`);return r};return Object.freeze({option:t("option"),singleSelectInput:t("single-select-input"),multiSelectInput:t("multi-select-input"),mobileMultiSelectInput:t("multi-select-input--mobile"),dropdownList:t("dropdown-list"),loadingNotification:t("loading-notification")})});function X(e){return{get option(){let t=e.querySelector(':scope > template[data-for="option"]');return t||A().option},get singleSelectInput(){return A().singleSelectInput},get multiSelectInput(){return A().multiSelectInput},get mobileMultiSelectInput(){return A().mobileMultiSelectInput},get dropdownList(){return A().dropdownList},get loadingNotification(){let t=e.querySelector(':scope > template[data-for="loading-notification"]');return t||A().loadingNotification}}}var te=Object.freeze({minQueryLength:3,debounceQueryDuration:250});function gt(e){return Object.freeze({get minQueryLength(){return ht(e,{attribute:"data-min-query-length",config:"minQueryLength"})},get debounceQueryDuration(){return ht(e,{attribute:"data-debounce-query-duration",config:"debounceQueryDuration"})}})}function ht(e,{attribute:t,config:o}){return mt(e.getAttribute(t))??mt(e.constructor?.config?.[o])??te[o]}function mt(e){return typeof e=="string"&&(e=Number.parseFloat(e)),typeof e=="number"&&Number.isInteger(e)&&e>=0?e:null}function yt(e,t=","){if(typeof e=="string")return bt([e],t);if(oe(e))return ne(e,t);if(ee(e))return bt(e,t);throw new TypeError("Input must be a string, Iterable, or AsyncIterable")}var ee=e=>typeof e?.[Symbol.iterator]=="function",oe=e=>typeof e?.[Symbol.asyncIterator]=="function";function*bt(e,t=","){let o="",n=null;for(let r of e){o+=r.toString();let a=o.split(/\r?\n/);o=a.pop()??"";for(let s of a){if(!s.trim())continue;let i=P(s,t);n?yield Object.fromEntries(n.map((l,c)=>[l,i[c]??""])):n=i}}if(o.trim()&&n){let r=P(o,t);yield Object.fromEntries(n.map((a,s)=>[a,r[s]??""]))}}async function*ne(e,t=","){let o="",n=null;for await(let r of e){o+=r.toString();let a=o.split(/\r?\n/);o=a.pop()??"";for(let s of a){if(!s.trim())continue;let i=P(s,t);n?yield Object.fromEntries(n.map((l,c)=>[l,i[c]??""])):n=i}}if(o.trim()&&n){let r=P(o,t);yield Object.fromEntries(n.map((a,s)=>[a,r[s]??""]))}}function P(e,t=","){let o=[],n="",r=!1;for(let a=0;a<e.length;a++){let s=e[a],i=e[a+1];s==='"'&&r&&i==='"'?(n+='"',a++):s==='"'?r=!r:s===t&&!r?(o.push(n),n=""):n+=s}return o.push(n),o}async function*j(e){let{body:t}=e;if(!t)return;let o=t.getReader(),n=new TextDecoder;for(;;){let{done:r,value:a}=await o.read();if(r)break;yield n.decode(a)}}function x(e){if(e instanceof Response){let t=e.headers.get("Link");return Z(t)}return Z(typeof e=="string"?e:null)}function O(e){if(!(e instanceof Response))return!1;for(let t of["Has-More","X-Has-More"]){let o=e.headers.get(t);if(o)return o.toLowerCase()==="true"}return!1}function Z(e){if(!e||e.length<=0)return{entries:[],byRel:{}};let t=Iterator.from(re(e)).map(ae).filter(n=>n!=null).toArray(),o={};for(let n of t){let{params:{rel:r}}=n;if(r)for(let a of r.split(" ").filter(Boolean))o[a]??=[],o[a].push(n)}return{entries:t,byRel:o}}function re(e){let t=[],o=[],n="",r=!1,a=!1,s=!0;for(let i=0,l=e.length;i<l;i++){let c=e[i];if(a&&c!==">"||r&&c!=='"'){n+=c;continue}if(c==="<"&&s&&(a=!0,s=!1),c===">"&&(a=!1),c==='"'&&(r=!r),c===";"){o.push(n),n="";continue}c===","?(o.push(n),t.push(o),n="",o=[],s=!0):n+=c}return n&&(o.push(n),t.push(o)),t}function ae(e){let[t,...o]=e,n=t.match(/<([^>]+)>/);if(!n)return null;let r=n[1],a=Object.fromEntries(Iterator.from(o).map(s=>s.trim()).filter(Boolean).map(s=>s.match(/^([^=]+)="?([^"]+)"?$/)).filter(s=>s!=null).map(s=>{let[,i,l]=s;return[i,l]}).toArray());return{url:r,params:a}}async function vt(e){if(!tt(e))throw Error("Not an CSV response");let t=x(e),o=O(e),n=await Array.fromAsync(yt(j(e)));return t.byRel.next?{hasMore:!0,navigationMode:"link",href:t.byRel.next[0].url,data:n}:o?{hasMore:!0,navigationMode:"after_value",data:n}:{hasMore:!1,data:n}}function tt(e){return e instanceof Response&&e.ok&&e.headers.get("Content-Type")==="text/csv"}async function wt(e){if(!et(e))throw Error("Not an JSON response");let t=await e.json();return Array.isArray(t)?se(t,e):ie(t,e)}function se(e,t){let o=x(t),n=O(t),r=e;return o.byRel.next?{hasMore:!0,navigationMode:"link",href:o.byRel.next[0].url,data:r}:n?{hasMore:!0,navigationMode:"after_value",data:r}:{hasMore:!1,data:r}}function ie(e,t){let{links:o,hasMore:n,records:r}=e,a=r,s=typeof o?.next=="string"?o.next:x(t).byRel.next?.[0]?.url,i=n??O(t);return s?{hasMore:!0,navigationMode:"link",href:s,data:a}:i?{hasMore:!0,navigationMode:"after_value",data:a}:{hasMore:!1,data:a}}function et(e){return e.ok&&e.headers.get("Content-Type")==="application/json"}function Ot(e){if(typeof e=="string")return xt([e]);if(ce(e))return ue(e);if(le(e))return xt(e);throw new TypeError("Input must be a string, Iterable, or AsyncIterable")}var le=e=>typeof e?.[Symbol.iterator]=="function",ce=e=>typeof e?.[Symbol.asyncIterator]=="function";function*xt(e,t=","){let o="";for(let n of e){o+=n.toString();let r=o.split(/\r?\n/);o=r.pop()??"";for(let a of r)a.trim()&&(yield JSON.parse(a))}o.trim()&&(yield JSON.parse(o))}async function*ue(e){let t="";for await(let o of e){t+=o.toString();let n=t.split(/\r?\n/);t=n.pop()??"";for(let r of n)r.trim()&&(yield JSON.parse(r))}t.trim()&&(yield JSON.parse(t))}async function kt(e){if(!ot(e))throw Error("Not an CSV response");let t=x(e),o=O(e),n=(await Array.fromAsync(Ot(j(e)))).filter(h);return t.byRel.next?{hasMore:!0,navigationMode:"link",href:t.byRel.next[0].url,data:n}:o?{hasMore:!0,navigationMode:"after_value",data:n}:{hasMore:!1,data:n}}function ot(e){return e.ok&&e.headers.get("Content-Type")==="application/jsonl"}var St=new WeakMap;function R(e){let t=St.get(e);return t||(t=pe(new WeakRef(e)),St.set(e,t)),t}function pe(e){let t=()=>{let n=e.deref();if(!n)throw new Error("element no longer exists");return n},o={fetchData:async()=>await Mt(t()),fetchNextData:async()=>await fe(t()),fetchHistory:[],getLatestSuccessResponse(){for(let n=o.fetchHistory.length-1;n>=0;n--){let r=o.fetchHistory[n];if(r.completed){let a=r.result;if(!("error"in a))return a}}}};return o}function de(e,t){let o=null,n=0,r=new CustomEvent("datafetch",{cancelable:!0,composed:!0,bubbles:!0,detail:{dataToFetch:t,respondWith(a){o=a,n++}}});return e.dispatchEvent(r),{event:r,customResponse:o,respondWithCalls:n}}async function Mt(e){let t={query:W(e),url:Lt(e)};return At(e,t)}async function fe(e){let o=R(e).getLatestSuccessResponse();if(o==null)return await Mt(e);if(!o.hasMore)return Object.freeze({data:[],hasMore:!1});let n=(()=>{if(o.navigationMode==="link")return{query:W(e),url:o.href};if(o.navigationMode==="after_value"){let r=o.data.at(-1)?.value,a=r?Object.freeze({after:String(r)}):{};return{query:W(e),url:Lt(e,a)}}})();return n?At(e,n):(console.error("error getting next data: unreachable code detected, aborting fetch"),o)}async function At(e,t){let o=me(e,{dataToFetch:t,loadingMode:"sync",status:"dispatching event",result:null,completed:!1}),{event:n,customResponse:r,respondWithCalls:a}=de(e,t);if(a>0){let i=typeof r?.then=="function",l=r instanceof Response;if(o.loadingMode=i||l?"async":"sync",o.result=await he(r),o.completed=!0,"error"in o.result)throw Error(o.result.error);return o.result}let{url:s}=t;if(!n.defaultPrevented&&s){o.loadingMode="async",o.status="fetching data";let i=await fetch(s);if(o.status="parsing response",o.result=await Et(i),o.status=Object.hasOwn(o.result,"error")?"error":"completed",o.completed=!0,"error"in o.result)throw Error(o.result.error);return o.result}if(!s)return o.loadingMode="sync",o.completed=!0,o.result={data:[],hasMore:!1},o.result;throw o.loadingMode="sync",o.completed=!0,o.result={error:"no data loaded",stage:"loading data"},Error("no data to load")}async function he(e){let t=await Promise.resolve(e);if(t instanceof Response){let o=await Et(t);return"error"in o&&(o.error=`parse event .respondWith(Response): ${o.error}`),o}if(Array.isArray(t))return{data:t,hasMore:!1};if(h(t)){let{hasMore:o,links:n,records:r}=t;if(!Array.isArray(r))return{error:`records property must be an array, instead it is ${r}`,stage:"parse event .respondWith(Object)"};if(typeof n?.next=="string")return{data:r,hasMore:!0,navigationMode:"link",href:n.next};if(o)return{data:r,hasMore:!0,navigationMode:"after_value"}}return{error:"invalid data on RespondsWith, param must be an array, plain object or Response",stage:"parse event .respondWith(...)"}}async function Et(e){return e.ok?tt(e)?await vt(e):et(e)?await wt(e):ot(e)?await kt(e):{error:'invalid response, expected JSON, JSON Lines or CSV response, guarantee that Content-type header is set correctly to "text/csv", "application/json" or "application/jsonl"',stage:"parse fetch response"}:{error:`${e.status} HTTP status code`,stage:"parse fetch response"}}function me(e,t){let{fetchHistory:o}=R(e);return o.push(t),o.length>128&&o.shift(),t}var W=e=>e.getAttribute("data-filter")??"",ge=e=>e.getAttribute("data-src")??"",Lt=(e,t={})=>{let o=ge(e);if(!o)return o;let n=W(e),r=new URL(o,window.location.href);n&&r.searchParams.set("q",n);for(let[a,s]of Object.entries(t))r.searchParams.set(a,s);return r.href};var V={};Kt(V,{cancelButtonEl:()=>T,containerEl:()=>nt,dropdownEl:()=>k,dropdownOptionList:()=>ve,getDynamicOptions:()=>N,getHostDynamicSelect:()=>ke,inputEl:()=>rt,isClearButton:()=>Oe,isDeselectButton:()=>xe,isDynamicSelect:()=>E,isDynamicSelectSymbol:()=>H,isSearchInputEl:()=>we,okButtonEl:()=>C,searchInputEl:()=>be,valueListEl:()=>ye});var nt=b("div.container"),be=b("input.search-input"),rt=b("span.input"),k=b("dialog.dropdown"),ye=b("dialog.dropdown > ul.value-list"),C=b("dialog.dropdown > .buttons > .ok"),T=b("dialog.dropdown > .buttons > .cancel"),N=b("div.dynamic-options:not(.option *)"),ve=Se("li.option-value:not(.option *)"),we=at("input.search-input"),xe=at(".multiselect-option[data-value] > button.deselect-option"),Oe=at("a.clear-button:not(.option *)"),H=Symbol("its-a-dynamic-select");function ke(e){if(!(e instanceof Element))throw Error("target is not an element");let t=e.getRootNode();if(!(t instanceof ShadowRoot))throw Error("target is not inside a shadow dom");let o=t.host;if(!E(o))throw Error("target is not inside a Dynamic Select shadow dom");return o}function b(e){return t=>{let o=t.shadowRoot?.querySelector(e);if(!o)throw Error(`Error: no ${JSON.stringify(e)} found in dynamic select shadow DOM`);return o}}function Se(e){return t=>{let o=t.shadowRoot?.querySelectorAll(e);if(o==null)throw Error("shadow is not yet defined");return o}}function at(e){return function(t){return t instanceof Element&&t.matches(e)}}function E(e){return e?e[H]===!0:!1}var Dt=new WeakMap;function m(e){let t=Dt.get(e);return t||(t=Me(new WeakRef(e)),Dt.set(e,t)),t}function Me(e){let t=()=>{let n=e.deref();if(!n)throw new Error("element no longer exists");return n},o={selectedValues:new Set,get options(){return[...N(t()).querySelectorAll(":scope > option")]},get optionsData(){return o.options.map(n=>Object.freeze({...w(n),origin:"fetch"}))},get optionsMap(){return Object.fromEntries(o.options.map(n=>[n.value,n]))},status:"empty",loadData:()=>Ae(t()),loadNextData:()=>Ee(t()),get values(){return Iterator.from(o.options).filter(n=>n.selected).map(n=>n.value).toArray()},set values(n){o.selectedValues=new Set(...n),o.options.forEach(r=>{r.selected=n.includes(r.value)})},toggleValue(n,r){let a=r??!o.selectedValues.has(n);a?o.selectedValues.delete(n):o.selectedValues.add(n),Iterator.from(o.options).filter(s=>s.value===n).forEach(s=>{s.selected=a})},get selectedOptions(){return Iterator.from(o.options).filter(n=>n.selected).toArray()}};return o}async function Ae(e){let t=R(e),o=N(e),n=nt(e);try{let r=t.fetchData(),a=t.fetchHistory.at(-1)?.loadingMode==="async";n.setAttribute("load-mode",a?"async":"sync"),n.toggleAttribute("data-loading",a);let s=await r,i=m(e),{selectedValues:l}=i,c=i.optionsMap;for(let u of s.data){let f=It(u,l);c[f.value]==null&&o.append(Y(f))}}catch(r){console.error(r)}finally{n.removeAttribute("data-loading")}}async function Ee(e){let t=R(e),o=N(e);try{let n=await t.fetchNextData(),r=m(e),{selectedValues:a}=r,s=r.optionsMap;for(let i of n.data){let l=It(i,a);s[l.value]==null&&o.append(Y(l))}}catch(n){console.error(n)}}function It(e,t){let o=String(e.value);return{value:o,text:e.text??o,selected:t.has(o),origin:"fetch",data:e}}var F=class{constructor(t=[]){for(let[o,n]of t)this.set(o,n)}get size(){return Tt(this)}delete(t){return Rt(t,this)}clear(){Ct(this)}forEach(t,o){for(let[n,r]of this.entries())t.call(o,r,n,this)}get(t){return d(this).refWeakMap.get(t)?.value}has(t){return d(this).refWeakMap.has(t)}*keys(){yield*z(this)}set(t,o){let{keySet:n,refWeakMap:r}=d(this),a=r.get(t);if(a!==void 0)return a.value=o,this;let s=new WeakRef(t);return r.set(t,{ref:s,value:o}),n.add(s),this}*values(){for(let[,t]of this.entries())yield t}*entries(){let{refWeakMap:t}=d(this);for(let o of this.keys()){let n=t.get(o);n&&(yield[o,n.value])}}[Symbol.iterator](){return this.entries()}},L=class{constructor(t=[]){for(let o of t)this.add(o)}get size(){return Tt(this)}delete(t){Rt(t,this)}clear(){Ct(this)}forEach(t,o){for(let n of this.entries())t.call(o,n,n,this)}has(t){return d(this).refWeakMap.has(t)}add(t){let{keySet:o,refWeakMap:n}=d(this);if(n.has(t))return this;let r=new WeakRef(t);return n.set(t,{ref:r,value:!0}),o.add(r),this}*keys(){yield*z(this)}*values(){yield*z(this)}*entries(){yield*z(this)}[Symbol.iterator](){return this.entries()}};function*z(e){let{keySet:t}=d(e),o=Array.from(t);for(let n of o){let r=n.deref();if(!r){t.delete(n);continue}yield r}}function Rt(e,t){let{keySet:o,refWeakMap:n}=d(t),r=n.get(e);return r?(o.delete(r.ref),n.delete(e),!0):!1}function Ct(e){let{keySet:t,refWeakMap:o}=d(e),n=Array.from(t);for(let r of n){let a=r.deref();a&&o.delete(a)}t.clear()}function Tt(e){let{keySet:t}=d(e);return t.forEach(o=>{o.deref()||t.delete(o)}),t.size}var d=(()=>{let e=new WeakMap;function t(n){let s={keySet:new Set,refWeakMap:new WeakMap};return e.set(n,s),s}function o(n){return e.get(n)??t(n)}return o})();var $t=window.matchMedia("(max-width: 576px) and (orientation: portrait)"),Pt=window.matchMedia("(max-width: 768px) and (orientation: landscape)"),jt=()=>"ontouchstart"in window||navigator.maxTouchPoints>0,Le=()=>$t.matches&&jt(),De=()=>Pt.matches&&jt(),g=()=>Le()||De(),Wt=new F;function Nt(){let e=g();for(let t of Wt.values()){let{currentIsMobile:o,observingNodes:n,callback:r}=t;if(o===e)continue;t.currentIsMobile=e;let a=Iterator.from(n).map(s=>({target:s,isMobile:e})).toArray();r(a)}}var Ht=()=>{$t.addEventListener("change",Nt),Pt.addEventListener("change",Nt),Ht=()=>{}},J=class{#t;constructor(t){this.#t={callback:t,observingNodes:new L,currentIsMobile:void 0},Wt.set(this,this.#t)}observe(t){Ht();let o=this.#t;o.currentIsMobile===void 0&&(o.currentIsMobile=g());let{currentIsMobile:n,callback:r,observingNodes:a}=o;a.add(t),r([{target:t,isMobile:n}])}};function Vt(){return g()}var Ie=(()=>{let e=new L,t=window.visualViewport;if(!t)return{applyOnSelect(){}};let o=()=>{t.addEventListener("scroll",a),t.addEventListener("resize",a)},n=()=>{t.removeEventListener("scroll",a),t.removeEventListener("resize",a)},r=i=>{let l=t.offsetLeft,c=t.offsetTop,u=i.getBoundingClientRect(),f=l+(t.width-u.width)/2,K=c+(t.height-u.height)/2;i.style.transform=`translate(${f}px, ${K}px) scale(${1/t.scale})`,i.style.transformOrigin="top left"},a=()=>{if(e.size<=0){n();return}for(let i of e){if(!i.open){e.delete(i);continue}r(k(i))}};return{applyOnSelect:i=>{if(e.add(i),i.open){let l=k(i);r(l),r(l)}o()}}})();function zt(e){let t=k(e);Ie.applyOnSelect(e),t.classList.remove("top-direction","left-direction"),t.style.marginTop="",t.style.marginLeft=""}var Ft=new WeakMap,Jt=new IntersectionObserver(e=>{new Set(Iterator.from(e).filter(o=>!o.isIntersecting).map(o=>o.target).filter(E)).forEach(o=>{o.open=!1,q(o).stopAnchoringToSelect()})});function q(e){let t=Ft.get(e);return t||(t=Re(new WeakRef(e)),Ft.set(e,t)),t}function Re(e){let t=()=>{let u=e.deref();if(!u)throw l(),new Error("element no longer exists");return u},o=()=>{let u=t();if(!u.open){c.stopAnchoringToSelect();return}B(u)},n=()=>document.defaultView?.addEventListener("scroll",o,!0),r=()=>document.defaultView?.removeEventListener("scroll",o,!0),a=()=>document.defaultView?.addEventListener("resize",o),s=()=>document.defaultView?.removeEventListener("resize",o),i=()=>{n(),a()},l=()=>{r(),s()},c={startAnchoringToSelect:()=>{let u=t();B(u),i(),Jt.observe(u)},stopAnchoringToSelect(){let u=t();Jt.unobserve(u),l()}};return c}function B(e){if(Vt()){zt(e);return}let t=k(e),n=rt(e).getBoundingClientRect();t.style.minWidth=`${n.width}px`;let r=Ce(),a=n.bottom+t.clientHeight>r.height,s=n.left+t.clientWidth>r.width,i=a?n.top:n.bottom,l=s?Math.min(r.width,n.right):Math.max(0,n.left);t.classList.toggle("top-direction",a),t.classList.toggle("left-direction",s),t.style.marginTop=`${i}px`,t.style.marginLeft=`${l}px`}function Ce(){let{visualViewport:e}=window;if(!e)return new DOMRectReadOnly(0,0,window.innerWidth,window.innerHeight);let{offsetLeft:t,offsetTop:o,width:n,height:r}=e;return new DOMRectReadOnly(t,o,n,r)}function*Bt(e){let t=e;for(;t!=null;){yield t;let{parentNode:o,parentElement:n}=t;if(o instanceof ShadowRoot){t=o.host;continue}if(o instanceof Document||n==null)return;t=n}}function qt(e){let t=e.ownerDocument.defaultView??globalThis;return t.navigator?(t.navigator.languages||[t.navigator.language])[0]:Intl.DateTimeFormat().resolvedOptions().locale}function Te(e){return e===e.ownerDocument.documentElement?qt(e):e.parentNode instanceof ShadowRoot?Q(e.parentNode.host):Q(e.parentElement)}function Q(e){if(e==null)return Intl.DateTimeFormat().resolvedOptions().locale;for(let t of Bt(e)){let o=t.getAttribute("lang");if(o)try{let n=new Intl.Locale(o),{language:r,region:a}=n;return a==null?r:`${r}-${a}`}catch{return Te(t)}}return qt(e)}var U=Object.freeze({ok:{default:"OK",es:"Aceptar",ar:"\u0645\u0648\u0627\u0641\u0642",hi:"\u0920\u0940\u0915 \u0939\u0948",tr:"Tamam",zh:"\u786E\u5B9A",ko:"\uD655\uC778"},cancel:{default:"Cancel",es:"Cancelar",zh:"\u53D6\u6D88",hi:"\u0930\u0926\u094D\u0926 \u0915\u0930\u0947\u0902",ar:"\u0625\u0644\u063A\u0627\u0621",tr:"\u0130ptal",fr:"Annuler",pt:"Cancelar",ru:"\u041E\u0442\u043C\u0435\u043D\u0430",id:"Batal",de:"Abbrechen",ja:"\u30AD\u30E3\u30F3\u30BB\u30EB",vi:"H\u1EE7y",ko:"\uCDE8\uC18C",it:"Annulla",pl:"Anuluj",uk:"\u0421\u043A\u0430\u0441\u0443\u0432\u0430\u0442\u0438"}}),Ne=new MutationObserver(e=>{for(let t of e){let{target:o}=t;if(!E(o)||!o.open)continue;let n=Q(o),a=new Intl.Locale(n).language,s=C(o);s.textContent=U.ok[a]??U.ok.default;let i=T(o);i.textContent=U.cancel[a]??U.cancel.default}}),$e={attributeFilter:["open"]};function Qt(e){Ne.observe(e,$e)}var Pe=I(()=>{let e=document.createElement("template");return e.innerHTML=lt,e}),je=I(()=>{let e=new CSSStyleSheet;return e.replaceSync(ct),e}),{searchInputEl:_,inputEl:it,dropdownEl:y,valueListEl:We,dropdownOptionList:st,getHostDynamicSelect:p,containerEl:He}=V,{isSearchInputEl:Ve,isDeselectButton:ze,isClearButton:Fe,isDynamicSelect:Je}=V,Be=new MutationObserver(e=>{}),qe={childList:!0,subtree:!0,attributes:!0,attributeFilter:["data-of-option"]},Qe=new J(e=>{for(let t of e){let{target:o,isMobile:n}=t;if(!Je(o))continue;o.open=!1;let a=getComputedStyle(o).getPropertyValue("--ui-mode").trim().toLowerCase(),s=["mobile","desktop"].includes(a)?a:null;He(o).setAttribute("data-ui-mode",s??(n?"mobile":"desktop")),M(o)}}),G=new WeakMap,$=class extends HTMLElement{constructor(){super();let t=this.attachShadow({mode:"open"});t.adoptedStyleSheets=[je()];let o=Pe();t.append(document.importNode(o.content,!0)),_(this).addEventListener("input",Ke),it(this).addEventListener("click",Xe),_(this).addEventListener("keydown",Ye),y(this).addEventListener("toggle",Ze),y(this).addEventListener("pointerdown",to),y(this).addEventListener("click",eo),C(this).addEventListener("click",oo),T(this).addEventListener("click",no),Be.observe(this,qe),Qe.observe(this),Qt(this)}connectedCallback(){S(this),M(this)}get searchFilter(){return this.getAttribute("data-filter")??""}set searchFilter(t){(t===""||t==null)&&this.removeAttribute("data-filter"),this.setAttribute("data-filter",String(t))}get value(){return this.valueAsArray[0]??""}set value(t){typeof t=="string"&&(this.valueAsArray=[t])}get valueAsArray(){let t=Iterator.from(this.selectedOptions).map(o=>o.value);return this.multiple||(t=t.take(1)),t.toArray()}set valueAsArray(t){Array.isArray(t)&&(Iterator.from(this.options).forEach(o=>{o.selected=t.includes(o.value)}),m(this).values=t)}get valueAsObjects(){let t=Iterator.from(this.selectedOptions).map(w).map(o=>o.data);return this.multiple||(t=t.take(1)),t.toArray()}set valueAsObjects(t){if(!Array.isArray(t))return;let o=a=>typeof a=="string"||!isNaN(a),n=Iterator.from(t).filter(h).filter(a=>o(a.value)).map(a=>[a.value,a]),r=Object.fromEntries(n);Iterator.from(this.options).forEach(a=>{let s=r[a.value];if(s){a.selected=!1;return}if(a.selected=!0,h(s)){let{text:i,value:l,...c}=s;Object.keys(c).length>0&&a.setAttribute("data-of-option",JSON.stringify(s))}})}get open(){return this.hasAttribute("open")}set open(t){typeof t=="boolean"&&this.toggleAttribute("open",t)}get[H](){return!0}get multiple(){return this.hasAttribute("multiple")}set multiple(t){typeof t=="boolean"&&this.toggleAttribute("multiple",t)}static get observedAttributes(){return["open","data-filter"]}get options(){return[...this.querySelectorAll("option"),...m(this).options]}get selectedOptions(){let{options:t}=this,o=Iterator.from(t).filter(r=>r.selected).toArray();if(o.length||this.multiple)return o;let n=t[0];return n?(n.selected=!0,[n]):[]}get src(){return this.querySelectorAll("option[selected]")}attributeChangedCallback(t,o,n){switch(t){case"open":if(this.open){let r=g();r?y(this).showModal():y(this).showPopover();let a=m(this).loadData();q(this).startAnchoringToSelect(),S(this),r&&_(this).blur(),a.then(()=>{S(this)})}else G.delete(this),g()?y(this).close():y(this).hidePopover(),q(this).stopAnchoringToSelect();break;case"data-filter":_(this).value=n,S(this),m(this).loadData().then(()=>{S(this)})}}};function Ue(e){let t=[],o={};for(let s of e.querySelectorAll(":scope > option"))t.push(w(s));for(let s of e.querySelectorAll(":scope > optgroup option")){let i=s.closest("optgroup")?.label,l=w(s);i?(o[i]??=[],o[i].push(l)):t.push(l)}let{optionsData:n}=m(e);for(let s of n){let i=s.data.group?.toString();i?(o[i]??=[],o[i].push(s)):t.push(s)}let{searchFilter:r}=e,{minQueryLength:a}=gt(e);if(typeof r=="string"&&r.trim()!==""&&r.length>=a){let s=Ge(r),i=t.filter(c=>s(c.text)),l={};for(let[c,u]of Object.entries(o)){if(s(c)){l[c]=u;continue}let f=u.filter(K=>s(K.text));f.length>0&&(l[c]=f)}return{ungroupedOptions:i,optionGroups:l}}return{ungroupedOptions:t,optionGroups:o}}function _e(e){let{ungroupedOptions:t,optionGroups:o}=Ue(e),n=e.multiple?"checkbox":"radio",a=[...st(e)].findIndex(s=>s.hasAttribute("data-focused"));return{ungroupedOptions:t.map(s=>({...s,checkedIndicatorType:n,focused:a--===0})),optionGroups:Object.entries(o).map(([s,i])=>({groupName:s,options:i.map(l=>({...l,checkedIndicatorType:n,focused:a--===0}))}))}}var Ge=e=>{let t=e.trim().toLocaleLowerCase();return o=>o.toLowerCase().includes(t)};function S(e){let t=_e(e),{dropdownList:o,option:n,loadingNotification:r}=X(e),a=v(o,t);a.querySelectorAll('slot[name="option"]').forEach(i=>{let l=JSON.parse(i.dataset.value||"{}");i.replaceWith(v(n,l))}),a.querySelectorAll('slot[name="loading-notification"]').forEach(i=>{i.replaceWith(v(r,t))}),We(e).replaceChildren(a)}function M(e){let{option:t,multiSelectInput:o,mobileMultiSelectInput:n,singleSelectInput:r}=X(e),a=e.multiple,s=a?g()?n:o:r,i=e.selectedOptions.map(w),l={isMultiple:a,isSingle:!a,selectedOptions:i,selectedOption:i[0]},c=v(s,l);c.querySelectorAll('slot[name="selected-option"]').forEach(u=>{let f=JSON.parse(u.dataset.value||"{}");u.replaceWith(v(t,f))}),it(e).replaceChildren(c)}function Ke(e){let{target:t}=e;if(!Ve(t))return;let o=p(t);o.searchFilter=t.value}function Ye(e){let{target:t,code:o}=e;console.log("AAA");let n="data-focused";if(o==="ArrowDown"||o==="ArrowUp"){let r=p(t),a=[...st(r)];if(a.length<=0)return;let s=a.findIndex(i=>i.hasAttribute(n));if(s>=0&&a[s].removeAttribute(n),e.code==="ArrowDown"){let i=s+1>=a.length?0:s+1;a[i].setAttribute(n,"")}else{let i=s<=0?a.length-1:s-1;a[i].setAttribute(n,"")}}else if(o==="Enter"){let r=p(t),s=[...st(r)].find(i=>i.hasAttribute("data-focused"));if(s instanceof HTMLLIElement){let i=s.dataset.value;if(typeof i!="string")return;Ut(i,r)}}}function Xe(e){let{target:t}=e;if(ze(t)){let o=t.closest(".multiselect-option");if(!(o instanceof HTMLElement))return;let n=o.dataset.value,r=p(o),a=r.selectedOptions.find(s=>s.value===n);if(a==null)return;a.selected=!1,m(r).toggleValue(a.value,!1),M(r)}else if(Fe(t)){let o=p(t);o.valueAsArray=[],M(o)}else{let o=p(e.target);o.open=!o.open}}function Ze(e){let t=p(e.target);t.open=y(t).matches(":popover-open,:open")}function to(e){let{target:t,currentTarget:o,clientX:n,clientY:r}=e;if(t===o&&o instanceof HTMLElement){let{left:s,right:i,bottom:l,top:c}=o.getBoundingClientRect();(n<s||n>i||r<c||r>l)&&(p(t).open=!1)}}function eo(e){let{target:t}=e;if(!(t instanceof Element))return;let o=t.closest("li.option-value:not(.option *)");if(!(o instanceof HTMLLIElement))return;let n=o.dataset.value;typeof n=="string"&&Ut(n,p(o))}function Ut(e,t){if(t.multiple){g()&&(G.get(t)||G.set(t,new Set(t.valueAsArray)));let n=new Set(t.valueAsArray).symmetricDifference(new Set([e]));t.valueAsArray=[...n],M(t),S(t),B(t)}else t.value=e,M(t),S(t),t.open=!1,it(t).querySelector("button")?.focus()}function oo(e){let{target:t}=e,o=p(t);o.open=!1}function no(e){let{target:t}=e,o=p(t),n=G.get(o)??new Set(o.valueAsArray);n&&(o.valueAsArray=[...n]),M(o),o.open=!1}var ro=new URL(import.meta.url),_t=ro.searchParams.get("named")?.trim();_t&&customElements.define(_t,$);var ao=$,wn=ao;export{ao as DynamicSelect,wn as default};
//# sourceMappingURL=dynamic-select.element.min.js.map
